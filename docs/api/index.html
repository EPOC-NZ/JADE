<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · JADE: a Julia DOASA Environment</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">JADE: a Julia DOASA Environment</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">JADE</a></li><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#Functions-to-set-up-JADE-model-/-data"><span>Functions to set up JADE model / data</span></a></li><li><a class="tocitem" href="#Functions-for-training-and-simulation"><span>Functions for training and simulation</span></a></li><li><a class="tocitem" href="#Visualisation-functions"><span>Visualisation functions</span></a></li><li class="toplevel"><a class="tocitem" href="#Internal-functions"><span>Internal functions</span></a></li><li><a class="tocitem" href="#Utility-functions"><span>Utility functions</span></a></li><li><a class="tocitem" href="#Data-input-functions"><span>Data input functions</span></a></li><li><a class="tocitem" href="#Data-processing-functions"><span>Data processing functions</span></a></li><li><a class="tocitem" href="#Data-output-functions"><span>Data output functions</span></a></li><li><a class="tocitem" href="#Structs"><span>Structs</span></a></li><li><a class="tocitem" href="#Modified-SDDP.jl-functionality"><span>Modified SDDP.jl functionality</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/EPOC-NZ/JADE/blob/main/docs/src/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="User-interface-functions"><a class="docs-heading-anchor" href="#User-interface-functions">User interface functions</a><a id="User-interface-functions-1"></a><a class="docs-heading-anchor-permalink" href="#User-interface-functions" title="Permalink"></a></h1><p>These functions are to be utilised by JADE users to set up and run JADE models.</p><h2 id="Functions-to-set-up-JADE-model-/-data"><a class="docs-heading-anchor" href="#Functions-to-set-up-JADE-model-/-data">Functions to set up JADE model / data</a><a id="Functions-to-set-up-JADE-model-/-data-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-to-set-up-JADE-model-/-data" title="Permalink"></a></h2><h3 id="Using-run-files"><a class="docs-heading-anchor" href="#Using-run-files">Using run files</a><a id="Using-run-files-1"></a><a class="docs-heading-anchor-permalink" href="#Using-run-files" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="JADE.define_JADE_model-Tuple{String}" href="#JADE.define_JADE_model-Tuple{String}"><code>JADE.define_JADE_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">define_JADE_model(inputdir::String; run_file::String = &quot;run&quot;)</code></pre><p>This function reads a JADE run file in the <code>Input/&lt;inputdir&gt;</code> folder. In particular, this function reads the parameters that are needed in order to define the SDDP model.</p><p><strong>Required Arguments</strong></p><p><code>inputdir</code> is the name of the subdirectory (within <code>Input</code>) that contains the JADE data files.</p><p><strong>Keyword Arguments</strong></p><p><code>run_file</code> is the name of the csv file that contains the parameters we wish to load.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/utilities.jl#L23-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.define_JADE_solve_options-Tuple{String}" href="#JADE.define_JADE_solve_options-Tuple{String}"><code>JADE.define_JADE_solve_options</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">define_JADE_solve_options(inputdir::String; run_file = &quot;run&quot;)</code></pre><p>This function loads the training options for JADE.</p><p><strong>Required Arguments</strong></p><p><code>inputdir</code> is the name of the subdirectory (within <code>Input</code>) where the <code>run_file</code> is located.</p><p><strong>Keyword Arguments</strong></p><p><code>run_file</code> is the name of the csv file containing the parameters for the simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/utilities.jl#L527-L538">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.define_JADE_simulation-Tuple{String}" href="#JADE.define_JADE_simulation-Tuple{String}"><code>JADE.define_JADE_simulation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">define_JADE_simulation(inputdir::String; run_file = &quot;run&quot;)</code></pre><p>This function reads a csv file containing the settings for a JADE simulation.</p><p><strong>Required Arguments</strong></p><p><code>inputdir</code> is the name of the subdirectory (within <code>Input</code>) where the <code>run_file</code> is located.</p><p><strong>Keyword Arguments</strong></p><p><code>run_file</code> is the name of the csv file containing the parameters for the simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/utilities.jl#L254-L265">source</a></section></article><h3 id="Using-Julia-scripts"><a class="docs-heading-anchor" href="#Using-Julia-scripts">Using Julia scripts</a><a id="Using-Julia-scripts-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Julia-scripts" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="JADE.define_JADE_model-Tuple{}" href="#JADE.define_JADE_model-Tuple{}"><code>JADE.define_JADE_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">define_JADE_model(;
    data_dir::String = &quot;&quot;,
    policy_dir::String = &quot;&quot;,
    start_year::Int = 0,
    start_week::Int = 1,
    total_weeks::Int = 52,
    hydro_sample_range::Union{Tuple{Int,Int},Int,UnitRange{Int},Vector} = 0,
    discount::Real = 0.0,
    losses::Symbol = :default,
    DIA::Int = 1,
    flow_penalties::Union{Tuple{Real,Real},NamedTuple{(:under, :over),&lt;:Tuple{Real,Real}}} = (
        500.0,
        50.0,
    ),
    weekly_discounting::Bool = true,
    scale_reservoirs::Real = 1.0,
    scale_objective::Real = 1.0,
    use_terminal_mwvs::Bool = false,
    first_week_known::Bool = false,
    steady_state::Union{Nothing,Bool} = nothing,
    decision_rules::Vector{DecisionRule} = DecisionRule[],
    scenario_dir::String = &quot;&quot;,
)</code></pre><p>This function sets the parameters that are needed in order to define the SDDP model.</p><p><strong>Required Arguments</strong></p><p><code>data_dir</code> is the name of the subdirectory (within <code>Input</code>) that contains the JADE data files.</p><p><code>policy_dir</code> is the name of the subdirectory (within <code>Output/data_dir</code>) that the cuts and simulation output will be stored in.</p><p><code>start_year</code> is the year that the policy is created for.</p><p><code>hydro_sample_range</code> is the set of years that define the hydro inflow distribution.</p><p><strong>Keyword Arguments</strong></p><p><code>start_week</code> is the first week of the <code>start_year</code>.</p><p><code>total_weeks</code> is the total number of weeks that the policy is created for.</p><p><code>discount</code> is the discount factor used for the steady-state model, must be less than 1. Setting this to 0 will set JADE to a finite horizon model. The terminal water values will only be used if <code>discount</code> is 0.</p><p><code>losses</code> sets the loss model; this can be <code>:none</code>, <code>:piecewise</code> or <code>:resistive</code>.</p><p><code>DIA</code> is the dynamic inflow adjustment parameter; 0 or 1 means no adjustment, higher values simulate an increased temporal correlation by increasing the variance.</p><p><code>flow_penalties</code> is a Tuple of the cost of violating the lower bound, upper bound flow constraints, respectively.</p><p><code>weekly_discounting</code> is a <code>Bool</code> which sets the discounting to occur in each stage rather than at the end of the horizon.</p><p><code>scale_reservoirs</code> this may be increased to improve numerical stability (~100).</p><p><code>scale_objective</code> scales down the objective function, this also scales down cuts (~1000).</p><p><code>use_terminal_mwvs</code> if set to <code>true</code> this will use the MWVs stored in <code>terminal_water_value.csv</code>, if set to <code>false</code> these won&#39;t be used.</p><p><code>first_week_known</code> if set to <code>true</code> the training will use deterministic inflows for the first week of the model. These will be sourced from the inflows recorded for that week and year.</p><p><code>steady_state</code> if set to <code>true</code> the training will operate in steady-state mode, if <code>false</code> the model will use a finite-horizon.</p><p><code>decision_rules</code> if any reservoir has restrictions on output, as a function of the storage, a <code>DecisionRule</code> can be applied. A vector of such decisions can be supplied via this argument.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/utilities.jl#L106-L177">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.define_JADE_solve_options-Tuple{}" href="#JADE.define_JADE_solve_options-Tuple{}"><code>JADE.define_JADE_solve_options</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">define_JADE_solve_options(;
    iterations::Int = 0,
    random_seed::Int = Int(floor((time() - floor(time())) * 10000)),
    risk::Union{Tuple{Real,Real},NamedTuple{(:lambda, :beta),&lt;:Tuple{Real,Real}}} = (
        0.0,
        1.0,
    ),
    warmstart_cuts::Bool = false,
    reset_starting_levels::Union{Symbol,Bool} = :default,
    saved_cuts::String = &quot;&quot;,
    cutselection::Int = 1,
    fractionMC::Float64 = 1.0
    custom_inflow_file::String = &quot;&quot;
    loadcuts_if_nonempty::Bool = false,
    eoh_cutfile::String = &quot;&quot;,
    write_eohcuts::Bool = false
)</code></pre><p>This function defines the training options for JADE.</p><p><strong>Keyword Arguments</strong></p><p><code>iterations</code> is the number of iterations of SDDP to complete when <code>optimize_policy!</code> is called.</p><p><code>random_seed</code> sets the random seed prior to sampling for the forward pass.</p><p><code>risk</code> is a Tuple <code>(λ,β)</code> defining the objective weight <code>λ</code> and the tail probability <code>β</code>.</p><p><code>warmstart_cuts</code> if set to <code>true</code>, this will load stored cuts before training.</p><p><code>reset_starting_levels</code> is used to reset the reservoirs in a steady-state model. This will enable a steady-state model to focus on a single starting set of reservoir levels (after initially finding an end-of-horizon value function).</p><p><code>saved_cuts</code> is the policy subdirectory from which the cuts should be loaded. If not specified, cuts will be loaded from the policy subdirectory set for the model.</p><p><code>cutselection</code> is an SDDP.jl parameter.</p><p><code>fractionMC</code> is the proportion of forward passes that are sampled using Monte-Carlo; the rest are sequentially sampled from the <code>sequences</code>.</p><p><code>custom_inflow_file</code> is the name of the file in the <code>Input/data_dir</code> directory containing the custom inflow sequences.</p><p><code>loadcuts_if_nonempty</code> if set to <code>true</code> cuts will be loaded from file even if cuts are already in the model.</p><p><code>eoh_cutfile</code> the name of end-of-horizon cut file for finite-horizon models.</p><p><code>write_eohcuts</code> if set to <code>true</code> steady-state models will write end-of-horizon cuts files.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/utilities.jl#L609-L664">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.define_JADE_simulation-Tuple{}" href="#JADE.define_JADE_simulation-Tuple{}"><code>JADE.define_JADE_simulation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">define_JADE_simulation(;
    sim_dir::String = &quot;&quot;,
    sim_type::Symbol = :not_set,
    replications::Int = 0,
    sim_years = nothing,
    randomize_years::Bool = false,
    reset_starting_levels::Bool = false,
    number_of_cycles::Int = 1,
    initial_stage::Int = 1,
    initial_state::Union{Nothing,Dict{String,&lt;:Real}} = nothing,
    random_seed::Int = Int(floor((time() - floor(time())) * 10000)),
)</code></pre><p>This function defines the settings for a JADE simulation.</p><p><strong>Keyword Arguments</strong></p><p><code>sim_dir</code> is the name of the subdirectory (within <code>Output/&lt;data_dir&gt;/&lt;policy_dir&gt;</code>) in which the simulation output will be stored.</p><p><code>sim_type</code> is the type of simulation; either <code>:monte_carlo</code> or <code>:historical</code>.</p><p><code>replications</code> is the number of sequences of inflows that are simulated. If the <code>sim_type</code> is <code>:monte_carlo</code> or <code>randomize_years</code> set to <code>true</code> then this argument must be set, otherwise it must not be set.</p><p><code>sim_years</code> specifies the years that will be simulated.</p><p><code>randomize_years</code> is used with historical simulations; if <code>true</code> this causes the simulation to randomly sample from <code>sim_years</code>, whereas if <code>false</code> the simulation will sample the years in sequence.</p><p><code>reset_starting_levels</code> is used to reset the reservoirs in a steady-state model. This will enable a simulation to sample a number of inflows sequences, with the reservoirs starting at the from the same points for each sequence.</p><p><code>number_of_cycles</code> is used with <code>reset_starting_levels</code> to show a simulation of multiple years, from a single single starting point. Must be used with a steady-state policy.</p><p><code>initial_state</code> is a vector of initial storage levels for the simulation, indexed by the reservoirs.</p><p><code>initial_stage</code> is the stage of the trained model that the simulation will start from.</p><p><code>random_seed</code> sets the random seed prior to generating the random inflow sequences.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/utilities.jl#L362-L407">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.create_JADE_model" href="#JADE.create_JADE_model"><code>JADE.create_JADE_model</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">create_JADE_model(rundata::RunData, optimizer)</code></pre><p>This function creates a <code>JADEModel</code> consisting of an SDDP policy graph, and the associated data.</p><p><strong>Required Arguments</strong></p><p><code>rundata</code> is the <code>RunData</code> object containing all the SDDP model details.</p><p><code>optimizer</code> is the JuMP optimizer you wish to use to train the policy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/utilities.jl#L496-L506">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.DecisionRule" href="#JADE.DecisionRule"><code>JADE.DecisionRule</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">function DecisionRule(
    slope::Real,
    intercept::Real,
    boundtype::Symbol,
    station::Symbol,
    reservoir::Symbol,
    flowtype::Symbol,
    weeks::T where {T&lt;:Union{Tuple{Int,Int},Int,UnitRange{Int},Vector}} = 1:52,
)</code></pre><p>This function constructs a DecisionRule object. See the JADE user documentation for further details. DecisionRules can be applied to spill and generation at hydro stations, these are both measured in MWh.</p><p><strong>Required Arguments</strong></p><p><code>slope</code> is the slope, w.r.t. the current storage in <code>reservoir</code>, of the (linear) bound applied to generation and / or spill flow corresponding to <code>station</code>. Units are MWh / Mm³.</p><p><code>intercept</code> is the bound applied to generation and / or spill flow corresponding to <code>station</code> when <code>reservoir</code> is at 0 storage.  Units are (MWh).</p><p><code>boundtype</code> is set to <code>:upper</code>, <code>:lower</code>, or <code>:equality</code> depending on how the flow should be restricted.</p><p><code>station</code> is the hydro station that the decision rule restricts.</p><p><code>reservoir</code> is the hydro reservoir whose  affects the bound applied.</p><p><code>flowtype</code> is set to <code>:generation</code>, <code>:spill</code>, or <code>:combined</code>.</p><p><code>weeks</code> defines the weeks in the year that the decision rule is in effect. E.g. [1:10,43:52].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/structs.jl#L66-L98">source</a></section></article><h2 id="Functions-for-training-and-simulation"><a class="docs-heading-anchor" href="#Functions-for-training-and-simulation">Functions for training and simulation</a><a id="Functions-for-training-and-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-for-training-and-simulation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="JADE.optimize_policy!" href="#JADE.optimize_policy!"><code>JADE.optimize_policy!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">optimize_policy!(
    JADEmodel::JADEModel,
    solveoptions::JADESolveOptions;
    async::Bool = false,
    print_level::Int = 1,
)</code></pre><p>This function trains the <code>JADEmodel</code>.</p><p>The output from this simulation will automatically be written into the Output/<code>data_dir</code>/<code>policy_dir</code>/<code>sim_dir</code> subdirectory.</p><p><strong>Required Arguments</strong></p><p><code>JADEmodel</code> is the model detailing the year that we wish to create a policy for, and all the corresponding data.</p><p><code>solveoptions</code> contains all the SDDP.jl settings, as well as settings and directories for loading cuts.</p><p><strong>Keyword Arguments</strong></p><p><code>async</code> is a boolean that sets whether SDDP.jl will run in parallel. Currently recommended to be set to false.</p><p><code>print_level</code> is an SDDP.jl setting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/solve.jl#L8-L33">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.simulate" href="#JADE.simulate"><code>JADE.simulate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">simulate(JADEmodel::JADEModel, parameters::JADESimulation)</code></pre><p>This function carries out a simulation of a JADE model; all the specifications for this simulation are defined within the <code>parameters</code> argument.</p><p>The output from this simulation will automatically be written into the Output/<code>data_dir</code>/<code>policy_dir</code>/<code>sim_dir</code> subdirectory.</p><p><strong>Required Arguments</strong></p><p><code>JADEmodel</code> is the model detailing the scenario that we wish to simulate, and all the corresponding data.</p><p><code>parameters</code> contains all the simulation information, including the number of replications, the type of simulation, the hydrological years to sample from, etc.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/simulate.jl#L10-L25">source</a></section></article><h2 id="Visualisation-functions"><a class="docs-heading-anchor" href="#Visualisation-functions">Visualisation functions</a><a id="Visualisation-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Visualisation-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="JADE.plot_storage" href="#JADE.plot_storage"><code>JADE.plot_storage</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_storage(
    results::Array{Array{Dict{Symbol,Any},1},1},
    filename::String = randstring(6);
    reservoirs::Array{Symbol,1} = collect(keys(results[1][1][:reslevel])),
)</code></pre><p>This function plots the storage in each of the reservoirs (Mm³) alongside the total storage (GWh) as an interactive webpage.</p><p><strong>Required Arguments</strong></p><p><code>results</code> is the output from a JADE simulation.</p><p><strong>Keyword Arguments</strong></p><p><code>filename</code> is the name of the file in which you wish to store the visualisation; the filename will be a random string if omitted.</p><p><code>reservoirs</code> is an array of Symbols for the reservoirs that are to be visualised.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/visualise.jl#L10-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.plot_prices" href="#JADE.plot_prices"><code>JADE.plot_prices</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_prices(
    results::Array{Array{Dict{Symbol,Any},1},1},
    filename::String = randstring(6);
    nodes::Array{Symbol,1} = results[1][1][:prices].axes[1],
    blocks::Array{Symbol,1} = results[1][1][:prices].axes[2],
)</code></pre><p>This function plots the prices for each of the nodes and load blocks alongside the total storage (GWh) as an interactive webpage.</p><p><strong>Required Arguments</strong></p><p><code>results</code> is the output from a JADE simulation.</p><p><strong>Keyword Arguments</strong></p><p><code>nodes</code> is an array of Symbols for the nodes that are to be visualised.</p><p><code>filename</code> is the name of the file in which you wish to store the visualisation; the filename will be a random string if omitted.</p><p><code>blocks</code> is an array of Symbols for the load blocks that are to be visualised.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/visualise.jl#L65-L85">source</a></section></article><h1 id="Internal-functions"><a class="docs-heading-anchor" href="#Internal-functions">Internal functions</a><a id="Internal-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-functions" title="Permalink"></a></h1><p>These are internal functions within JADE that should only be used or modified by persons who have a deep understanding of the underlying SDDP model.</p><h2 id="Utility-functions"><a class="docs-heading-anchor" href="#Utility-functions">Utility functions</a><a id="Utility-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Utility-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="JADE.gettimeseries" href="#JADE.gettimeseries"><code>JADE.gettimeseries</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gettimeseries(file::String)</code></pre><p>Read timeseries with arbitrary number of columns from <code>file</code>.</p><p><strong>Required Arguments</strong></p><p><code>file</code> is the name of the file from which JADE is loading Timeseries data.</p><p><strong>Example File</strong></p><pre><code class="nohighlight hljs">% Data (A,B,C)
YEAR,WEEK,A,B,C
2005,1,4,18.68,4.49
2005,2,4,18.68,4.49</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data.jl#L95-L109">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.calculatetime" href="#JADE.calculatetime"><code>JADE.calculatetime</code></a> — <span class="docstring-category">Function</span></header><section><div><p>This function returns the year and week, given a stage.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/time.jl#L131-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.cleandata" href="#JADE.cleandata"><code>JADE.cleandata</code></a> — <span class="docstring-category">Function</span></header><section><div><p>For a data frame containing columns named WEEK and YEAR, return only the subset of data that falls within a relevant time range.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/time.jl#L117-L120">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.between" href="#JADE.between"><code>JADE.between</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Determines if a time point is between two other time points, inclusive</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/time.jl#L110-L112">source</a></section></article><h2 id="Data-input-functions"><a class="docs-heading-anchor" href="#Data-input-functions">Data input functions</a><a id="Data-input-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Data-input-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="JADE.parsefile" href="#JADE.parsefile"><code>JADE.parsefile</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">parsefile(f::Function, file::String, trim::Bool = false)</code></pre><p>This function reads in a data file and extracts each of the non-comment / non-empty rows, splits into into a vector using &#39;,&#39; as the delimiter, and then applies some custom processing <code>f</code>.</p><p><strong>Required Arugments</strong></p><p><code>f</code> custom function that processes a line of the data file.</p><p><code>file</code> path of the file.</p><p><strong>Keyword Arguments</strong></p><p><code>trim</code> if <code>true</code> trailing commas will be discarded.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data.jl#L10-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.getitems" href="#JADE.getitems"><code>JADE.getitems</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getitems(io::IOStream, trim::Bool)</code></pre><p>This function takes an <code>IOStream</code> for a CSV file and reading the first line, decarding empty / comment rows, and otherwise splitting into into a vector using &#39;,&#39; as the delimiter. This vector is returned.</p><p><strong>Required Arugments</strong></p><p><code>io</code> <code>IOStream</code> object for a CSV file.</p><p><code>trim</code> if <code>true</code> trailing commas will be discarded.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data.jl#L35-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.parse_run_options" href="#JADE.parse_run_options"><code>JADE.parse_run_options</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">parse_run_options(file::String)</code></pre><p>This function loads a run file (CSV) creates a <code>Dict</code> that has keys corresponding to various <code>JADE</code> <code>RunData</code> fields, and their associated values.</p><p><strong>Required Arugments</strong></p><p><code>file</code> is the path to the run file that is being loaded.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data.jl#L69-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.gethydros" href="#JADE.gethydros"><code>JADE.gethydros</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gethydros(file::String)</code></pre><p><strong>Description</strong></p><p>Read list of hydro station data from <code>file</code>. Capacity in MW; Specific power in MW/cumec; Spillway max flow in cumecs (can be zero if no spillway exists, or &quot;na&quot; for unlimited spill). The columns MUST be ordered as shown below.</p><p><strong>Example File</strong></p><pre><code class="nohighlight hljs">GENERATOR,HEAD_WATER_FROM,TAIL_WATER_TO,POWER_SYSTEM_NODE,CAPACITY,SPECIFIC_POWER,SPILLWAY_MAX_FLOW
Arapuni,Lake_Arapuni,Lake_Karapiro,NI,196.7,0.439847649,99999</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data/hydro.jl#L188-L203">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.getinflows_for_historical" href="#JADE.getinflows_for_historical"><code>JADE.getinflows_for_historical</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Returns an inflow matrix (actually a vector) for a given year</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data/hydro.jl#L454-L456">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.getnaturalarcs" href="#JADE.getnaturalarcs"><code>JADE.getnaturalarcs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getnaturalarcs(file::String)</code></pre><p><strong>Description</strong></p><p>Read list of hydro station data from <code>file</code>. Canals, rivers, and other means of getting water from one place to another. Excludes power station turbines and spillways; those are covered in the hydro<em>stations file. Min/max flow in cumecs. NA in MIN</em>FLOW converted to 0.0 NA in MAX_FLOW converted to 99999.0 The columns MUST be ordered as shown below.</p><p><strong>Example File</strong></p><pre><code class="nohighlight hljs">ORIG,DEST,MIN_FLOW,MAX_FLOW
Lake_Wanaka,Lake_Dunstan, NA, NA
Lake_Hawea,Lake_Dunstan, 0.00, 99999</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data/hydro.jl#L130-L148">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.getterminalvalue" href="#JADE.getterminalvalue"><code>JADE.getterminalvalue</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getterminalvalue(file::String)</code></pre><p><strong>Description</strong></p><p>At the final stage terminal cost is a piecewise linear function of the national stored energy. We define a number of linear equations.</p><ul><li>Value of stored energy in hydro lakes at the end of the time horizon.</li><li>STORED_ENERGY is the cumulative stored energy in GWh.</li><li>VALUE is the marginal value in /MWh. This column should be a decreasing sequence.</li></ul><p>The columns MUST be ordered as shown below.</p><p><strong>Example File</strong></p><pre><code class="nohighlight hljs">STORED_ENERGY, VALUE
1000, 137.218398630355   % first 1000 GWh is worth ~ $137/MWh
1500, 85.9718321526058</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data/hydro.jl#L523-L542">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.getthermalstations" href="#JADE.getthermalstations"><code>JADE.getthermalstations</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getthermalstations(file::String, nodes::Vector{Symbol})</code></pre><p><strong>Description</strong></p><p>Read thermal station list from <code>file</code>. The columns MUST be ordered as shown below.</p><p><strong>Example File</strong></p><pre><code class="nohighlight hljs">% Thermal station data,,,,,,,,,
% Heat rate in GJ/MWh,,,,,,,,,
% Capacity in MW,,,,,,,,,
% O&amp;M cost in $/MWh,,,,,,,,,
GENERATOR,NODE,FUEL,HEAT_RATE,CAPACITY,OMCOST,START_YEAR,START_WEEK,END_YEAR,END_WEEK
Stratford_220KV,NI,gas,7.6,377,0,0,0,0,0
Huntly_e3p,NI,gas,7.2,403,0,2007,23,0,0
Huntly_main_g1,NI,coal,10.3,250,0,0,0,0,0
Huntly_main_g2,NI,coal,10.3,250,0,0,0,0,0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data/thermal.jl#L26-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.initialisereservoirs" href="#JADE.initialisereservoirs"><code>JADE.initialisereservoirs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initialisereservoirs(file::String, limits::String)</code></pre><p><strong>Description</strong></p><p>Read list of reservoirs from <code>file</code>. Capacity and initial contents in Mm³. The columns MUST be ordered as shown below.</p><p><strong>Example File</strong></p><pre><code class="nohighlight hljs">RESERVOIR, INFLOW_REGION, CAPACITY, INI_STATE
Lake_Benmore, SI, 423451075.96799916, 322000320.233399</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data/hydro.jl#L38-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.getdemand" href="#JADE.getdemand"><code>JADE.getdemand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getdemand(file::String, durations::JADE.TimeSeries{Dict{Symbol,Float64}})</code></pre><p><strong>Read the demand in MW</strong></p><p><strong>Example</strong></p><pre><code class="nohighlight hljs">% Demand (MW):
NODE,YEAR,WEEK,peak,shoulder,offpeak
NI,2005,1,2132.15,1616.51,1116.58</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data/demand.jl#L11-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.checkoutages" href="#JADE.checkoutages"><code>JADE.checkoutages</code></a> — <span class="docstring-category">Function</span></header><section><div><p>This function checks that there are no outages greater than the capacity of a station and outage data spans run length</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data/checks.jl#L68-L70">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.get_file_directory" href="#JADE.get_file_directory"><code>JADE.get_file_directory</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_file_directory(x::String, rundata::RunData; verbose::Bool = true)</code></pre><p>This function looks in various locations for input file <code>x</code>. If the rundata references a <code>scenario_dir</code> then the first directory to search is &lt;data<em>dir&gt;/data</em>files/&lt;scenario_dir&gt;.</p><p><strong>Required Arguments</strong></p><p><code>x</code> is the name of the input file. <code>rundata</code> is a <code>JADE</code> <code>RunData</code> object.</p><p><strong>Keyword Arguments</strong></p><p><code>verbose</code> if set to <code>true</code> the function will print info to the REPL.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/utilities.jl#L1179-L1193">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.check_settings_compatibility" href="#JADE.check_settings_compatibility"><code>JADE.check_settings_compatibility</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">check_settings_compatibility(;
    rundata::Union{Nothing,RunData} = nothing,
    solveoptions::Union{Nothing,JADESolveOptions} = nothing,
    simulation::Union{Nothing,JADESimulation} = nothing,
)</code></pre><p>This function checks the JADE settings for compatibility / consistency.</p><p><strong>Keyword Arguments</strong></p><p><code>rundata</code> contains the JADE model options. <code>solveoptions</code> contains the JADE training options. <code>simulation</code> contains the JADE simulation settings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/utilities.jl#L1006-L1021">source</a></section></article><h2 id="Data-processing-functions"><a class="docs-heading-anchor" href="#Data-processing-functions">Data processing functions</a><a id="Data-processing-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Data-processing-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="JADE.out_neighbors" href="#JADE.out_neighbors"><code>JADE.out_neighbors</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">out_neighbors(vertex::Symbol, edges::Vector{NTuple{2,Symbol}})</code></pre><p>Helper function to work out nodes that are adjacent and downstream.</p><p><strong>Required Arguments</strong></p><p><code>vertex</code> is the vertex in the network we are finding downstream neighbors for.</p><p><code>edges</code> is a vector of all the edges in the hydro network.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/network.jl#L10-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.hasdownstream" href="#JADE.hasdownstream"><code>JADE.hasdownstream</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">hasdownstream(
    sets::Sets,
    station_arcs::Dict{NTuple{2,Symbol},StationArc},
)</code></pre><p>This function is used to determine which hydro stations are present downstream from all reservoirs.</p><p><strong>Inputs</strong></p><p>sets                      A JADE set structure. Should include all arcs and nodes.   station_arcs              A dictionary we will use to get the station name from a station arc.</p><p><strong>Returns</strong></p><p>reservoir<em>has</em>downstream  A dictionary indexed by reservoirs that stores a                             list of hydro stations that each reservoir has                             between itself and the sea.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/network.jl#L30-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.adjustinflows" href="#JADE.adjustinflows"><code>JADE.adjustinflows</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">adjustinflows(inflow_file::String, rundata::RunData)</code></pre><p><strong>Description</strong></p><p>This method applies DIA to the inflow file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data/hydro.jl#L275-L281">source</a></section></article><h2 id="Data-output-functions"><a class="docs-heading-anchor" href="#Data-output-functions">Data output functions</a><a id="Data-output-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Data-output-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="JADE.diatofile" href="#JADE.diatofile"><code>JADE.diatofile</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">diatofile(
    adjusted::Dict{Symbol,TimeSeries{Float64}},
    outpath::String,
    policy_dir::String,
)</code></pre><p><strong>Description</strong></p><p>This function saves DIA adjusted inflows to file.</p><p><strong>Required Arguments</strong></p><p><code>adjusted</code> is the dictionary of DIA-adjusted inflows   <code>outpath</code> is the filename for adjusted inflows   <code>policy_dir</code> is the subdirectory where the outputs are stored</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data/hydro.jl#L365-L380">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.write_sim_results" href="#JADE.write_sim_results"><code>JADE.write_sim_results</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_sim_results(results, data::JADEData, parameters::JADESimulation)</code></pre><p>This function writes results from a simulation.</p><p><strong>Required arguments</strong></p><p><code>results</code> is a dictionary of results.</p><p><code>data</code> is a JADE data object for the problem simulated.</p><p><code>parameters</code> contains all the simulation settings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/results.jl#L8-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.write_training_results" href="#JADE.write_training_results"><code>JADE.write_training_results</code></a> — <span class="docstring-category">Function</span></header><section><div><p>This function saves output from policy generation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/results.jl#L282-L284">source</a></section></article><h2 id="Structs"><a class="docs-heading-anchor" href="#Structs">Structs</a><a id="Structs-1"></a><a class="docs-heading-anchor-permalink" href="#Structs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="JADE.RunData" href="#JADE.RunData"><code>JADE.RunData</code></a> — <span class="docstring-category">Type</span></header><section><div><p>An object containing the JADE model settings, required to define the stage problems in SDDP.jl.</p><p><strong>Fields</strong></p><p><code>data_dir::String</code> directory for writing output.</p><p><code>start_yr::Int</code> first year in the problem.</p><p><code>start_wk::Int</code> first week in the problem.</p><p><code>number_of_wks::Int</code> the number of weeks that we solve for.</p><p><code>sample_years::Vector{Int}</code> array of years that inflows are sampled from.</p><p><code>dialength::Int</code> inflow correlation length.</p><p><code>penalty_lb::Float64</code> penalty for flows below lower bound.</p><p><code>penalty_ub::Float64</code> penalty for flows above upper bound.</p><p><code>policy_dir::String</code> output directory for that the policy cuts and settings are stored in.</p><p><code>discount::Float64</code> steady-state discount factor (0 if finite-horizon).</p><p><code>losses::Symbol</code> type of losses (:none,:piecewise,:resistive).</p><p><code>nscenarios::Int</code> number of possible inflow realisations per week.</p><p><code>weekly_discounting::Bool</code> set to true if (equivalent) discount should applied weekly.</p><p><code>scale_reservoirs::Float64</code> scale factor for reservoirs.</p><p><code>scale_objective::Float64</code> scale factor for objective.</p><p><code>use_terminal_mwvs::Bool</code> boolean specifying whether we use the given terminal MWVs.</p><p><code>first_week_known::Bool</code> set to true if first-week inflow is set to historical value from training year.</p><p><code>steady_state::Bool</code> set to true if the model is steady-state.</p><p><code>decision_rules::Vector{DecisionRule}</code> vector of decision rules that can restrict how reservoirs are operated.</p><p><code>scenario_dir::String</code> name of directory within Input/&lt;data<em>dir&gt;/data</em>files/ containing data files that change within the scenario.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/structs.jl#L130-L174">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.JADESolveOptions" href="#JADE.JADESolveOptions"><code>JADE.JADESolveOptions</code></a> — <span class="docstring-category">Type</span></header><section><div><p>An object containing SDDP settings used when training a JADE model.</p><p><strong>Fields</strong></p><p><code>iterations::Int</code> sddp iterations to be performed.</p><p><code>riskmeasure::SDDP.AbstractRiskMeasure</code> sddp risk measure to use (set up to be CVaR).</p><p><code>warmstart_cuts::Bool</code> if true will load existing cuts, either from local directory or &#39;savedcuts&#39;.</p><p><code>reset_starting_levels::Union{Symbol,Bool}</code> if true will reset starting storage levels to initial values each forward pass.</p><p><code>seed::Int</code> random seed.</p><p><code>savedcuts::String</code> alternate folder from which to retrieve cuts.</p><p><code>cutselection::Int</code> sddp <code>cut_deletion_minimum</code> parameter.</p><p><code>fractionMC::Float64</code> fraction of forward passes using monte-carlo.</p><p><code>custom_inflow_file::String</code> file specifying sequences of inflows to be used in forward pass (fractionMC must be &lt; 1).</p><p><code>loadcuts_if_nonempty::Bool</code> set this to true if the cut file should be loaded into a model with existing cuts.</p><p><code>eoh_cutfile::String</code> EOH cut file to load as the cuts for the final stage of a finite-horizon model.</p><p><code>write_eohcuts::Bool</code> if true a steady-state model will write a set of files to Input/&lt;data_dor&gt;/EOH.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/structs.jl#L12-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.JADESimulation" href="#JADE.JADESimulation"><code>JADE.JADESimulation</code></a> — <span class="docstring-category">Type</span></header><section><div><p>An object containing JADE simulation settings.</p><p><strong>Fields</strong></p><p><code>sim_dir::String</code> is the folder that the simulation output should be written to (<code>Output/&lt;data_dir&gt;/&lt;policy_dir&gt;/&lt;sim_dir&gt;</code>).</p><p><code>sim_type::Symbol</code> is the type of simulation, either <code>:monte_carlo</code> or <code>:historical</code>.</p><p><code>replications::Int</code> is the number of replications of the simulation.</p><p><code>sim_years::Union{Nothing,Vector{Int}}</code> is either <code>nothing</code> or a vector of years that should be sampled from in the simulation.</p><p><code>randomize_years::Bool</code> if <code>true</code> the simulation will randomly choose years from <code>sim_years</code> (with replacement); otherwise the simulation sequentially samples the years from <code>sim_years</code> (in this case replications is automatically set).</p><p><code>reset_starting_levels::Union{Symbol,Bool}</code> if <code>true</code> the simulation will reset the initial storage levels after each iteration, even for steady-state models.</p><p><code>number_of_cycles::Int</code> for steady-state models, if this is greater than 1, each replication of the simulation will run <code>number_of_cycles</code> times; <code>reset_starting_levels</code> must be set to <code>true</code>.</p><p><code>initial_stage::Int</code> is the stage (not the week) of the simulation that the simulation will start from.</p><p><code>initial_state::Union{Nothing,Dict{String,Float64}}</code> is the initial state variables in the <code>initial stage</code></p><p><code>random_seed::Int</code> is the random seed for the simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/structs.jl#L237-L261">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.JADEData" href="#JADE.JADEData"><code>JADE.JADEData</code></a> — <span class="docstring-category">Type</span></header><section><div><p>An object containing all the data required to run the JADE model.</p><p><strong>Fields</strong></p><p><code>rundata</code> Run-related constants.</p><p><code>thermal_stations</code> Dictionary of thermal power station properties.</p><p><code>hydro_stations</code> Dictionary of hydro station properties.</p><p><code>reservoirs</code> Dictionary of reservoir properties.</p><p><code>fuel_costs</code> Time series of weekly fuel costs.</p><p><code>carbon_content</code> Carbon content for each fuel type.</p><p><code>inflow_mat</code> Structure for storing inflow scenarios.</p><p><code>station_arcs</code> Properties of arcs that correspond to hydro releases or spills.</p><p><code>natural_arcs</code> Arcs not going through hydro stations.</p><p><code>nodehas</code> Dictionary of node properties.</p><p><code>spMax</code> The maximum specific power value.</p><p><code>transmission</code> Dictionary of transmission line properties.</p><p><code>loops</code> Array of independent cycles in the transmission network, each entry being an array of arcs.</p><p><code>durations</code> Timeseries with block durations.</p><p><code>demand</code> Demand data.</p><p><code>outage</code> Outage each week for each station.</p><p><code>dr_tranches</code> Tranches for power-based demand response and load shedding.</p><p><code>en_tranches</code> Tranches for energy-based demand response.</p><p><code>terminal_eqns</code> Equations for terminal water value.</p><p><code>sets</code> Structure containing all sets for the JADE model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/data.jl#L291-L335">source</a></section></article><h2 id="Modified-SDDP.jl-functionality"><a class="docs-heading-anchor" href="#Modified-SDDP.jl-functionality">Modified SDDP.jl functionality</a><a id="Modified-SDDP.jl-functionality-1"></a><a class="docs-heading-anchor-permalink" href="#Modified-SDDP.jl-functionality" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="JADE.read_finalcuts_from_file" href="#JADE.read_finalcuts_from_file"><code>JADE.read_finalcuts_from_file</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function read_finalcuts_from_file(
	model::SDDP.PolicyGraph{T},
	filename::String,
	cutsfromstage::Int,
	laststage::Int;
	node_name_parser::Function = SDDP._node_name_parser,
) where {T}</code></pre><p><strong>Required Arguments</strong></p><p><code>model</code> The SDDP <code>PolicyGraph</code> that cuts are being loaded into.</p><p><code>filename</code> the full path to the cuts file being read.</p><p><code>cutsfromstage</code> the index of the stage (not necessarily the week of the year) that cuts should be extracted from.</p><p><code>laststage</code> the index of the stage of the model that the cuts are being loaded into.</p><p><code>node_name_parser</code> SDDP function to convert the <code>Int</code> for laststage into the name of the SDDP node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/sddp_modifications.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.write_cuts_to_file" href="#JADE.write_cuts_to_file"><code>JADE.write_cuts_to_file</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function write_cuts_to_file(
	model::SDDP.PolicyGraph{T},
	filename::String,
	start_wk::Int,
) where {T}</code></pre><p>This function writes a cuts json file that is modified so that stage 1 is always associated with week 1. This can only be used with a 52-week model. (It should only be used with steady-state JADE models.)</p><p><strong>Required Arguments</strong></p><p><code>model</code> The SDDP <code>PolicyGraph</code> that cuts are being written from.</p><p><code>filename</code> the full path to the cuts file being written.</p><p><code>start_wk</code> the week of the year that corresponds to stage 1 in the SDDP model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/sddp_modifications.jl#L106-L123">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.WrapHistorical" href="#JADE.WrapHistorical"><code>JADE.WrapHistorical</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">WrapHistorical(
    scenarios::Vector{Vector{Tuple{T,S}}},
    probability::Vector{Float64},
) where {T,S}</code></pre><p>A sampling scheme that samples a scenario from the vector of scenarios <code>scenarios</code> according to <code>probability</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">WrapHistorical(
    [
        [(1, 0.5), (2, 1.0), (3, 0.5)],
        [(1, 0.5), (2, 0.0), (3, 1.0)],
        [(1, 1.0), (2, 0.0), (3, 0.0)]
    ],
    [0.2, 0.5, 0.3],
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/sddp_modifications.jl#L204-L225">source</a></section><section><div><pre><code class="nohighlight hljs">WrapHistorical(scenarios::Vector{Vector{Tuple{T,S}}}) where {T,S}</code></pre><p>A deterministic sampling scheme that iterates through the vector of provided <code>scenarios</code>. The initial states in each iteration (other than the first) are set to the ending state of the previous forward pass.</p><p>Used in the forward pass of the training to enable custom inflow sequences in steady-state models (see <a href="https://github.com/EPOC-NZ/JADE/blob/master/src/solve.jl">solve.jl</a>).</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">WrapHistorical([
    [(1, 0.5), (2, 1.0), (3, 0.5)],
    [(1, 0.5), (2, 0.0), (3, 1.0)],
    [(1, 1.0), (2, 0.0), (3, 0.0)],
])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/sddp_modifications.jl#L240-L258">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JADE.InSampleMonteCarlo2" href="#JADE.InSampleMonteCarlo2"><code>JADE.InSampleMonteCarlo2</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">function InSampleMonteCarlo2(;
	max_depth::Int = 0,
	initial_stage::Int = 1,
	terminate_on_cycle::Bool = false,
	terminate_on_dummy_leaf::Bool = true,
	rollout_limit::Function = i -&gt; typemax(Int),
)</code></pre><p>This function creates an instance of the <code>InSampleMonteCarlo2</code> <code>sampling_scheme</code>. This is used for Monte Carlo simulations that may start from an arbitrary stage (<code>initial_stage</code>).</p><p><strong>Keyword Arguments</strong></p><p><code>max_depth</code> is the maximum number of stages to simulate.</p><p><code>initial_stage</code> is the stage number of the initial stage.</p><p><code>terminate_on_cycle</code> if <code>true</code> the simulation will stop if it returns to a previously visited node.</p><p><code>terminate_on_dummy_leaf</code> if <code>true</code> the simulation will may stop if it the probabilities of the noises don&#39;t sum to 1.</p><p><code>rollout_limit</code> is a function that allows the number of simulated stages to vary with the training iteration number.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EPOC-NZ/JADE/blob/b705880bfb472cb433c385b95d23f782404ded07/src/sddp_modifications.jl#L409-L433">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« JADE</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 27 September 2022 20:43">Tuesday 27 September 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
